---
title: "1c_Combining Arrest Data"
author: "Brit Henderson"
date: "Last Updated: `r format(Sys.time(), '%d %B, %Y')`"
output: html_document
---

# Objective
Combine the different charge types into one arrest counts file
```{r directories}
readdatdir <- "/data/share/xproject/Training/Practice/henderson/Dissertation/rda/Intermediate"
rdadir <- "/data/share/xproject/Training/Practice/henderson/Dissertation/rda"

```

```{r functions}

```

```{r packages}
# # Import packages
library(Hmisc)
library(tidyverse) # suite of packages in for manipulating/tidying/visualizing, etc. data
library(lubridate) # manipulating dates
library(readxl)  # read in excel files
library(knitr) # for RMD formatting
library(kableExtra) # to output tables as images
library(fastDummies) # easy creation of dummy variables 



```


#Load the data sets
```{r data}
dat.index <- readRDS(here::here("rda/Intermediate/int_index.rds"))
dat.prop <- readRDS(here::here("rda/Intermediate/int_prop.rds"))
dat.drug <- readRDS(here::here("rda/Intermediate/int_drug.rds"))
dat.other <- readRDS(here::here("rda/Intermediate/int_other.rds"))




```

# merge data sets
```{r merge}

#put all data frames into list
df_list <- list(dat.index, dat.prop, dat.drug, dat.other)      

#merge all data frames together
all.arrests <- df_list %>% reduce(full_join, 
                                  by= c("ori","ori9","year","state","country_division", "fips_place_code","agency_name","fips_state_county_code", "state_abb",
                                        "population_group","population","longitude","latitude","fips_county_code", "fips_state_code","covered_by","number_of_months_reported"))

```



#summary statistics for all arrests data set
```{r}
summary(dat6)
describe(dat6)
#There are 16 county-years observations that did not have any young adults
# The largest number of young adults is 1,097,486

dat6 %>% filter(is.na(State) ==1) %>%  #select(unique())
```
There are `r sum(is.na(dat5$n_young_adults)==1)` county-year observations that did not have any young adults.
There are `r count(filter(dat6,is.na(State)==1 & is.na(state)==0))` observations that are in the FIPS crosswalk but not in the population data set.
There are `r count(filter(dat6,is.na(State)==0 & is.na(state)==1))` observations that are in the population data set but not in the FIPS crosswalk. Most of these were for geographies in Puerto Rico, American Samoa, U.S. Virgin Islands, Northern Mariana Islands, and Guam. There were also
`r count(filter(dat6,is.na(State)==0 & is.na(state)==1, State = "VA")` records for Virginia and 1 record for Yellowstone National Park in Montana that did not match to any FIPS codes. This is fine.  
The largest number of young adults is 1,097,486.

#Cleaning final data set
```{r}
dat7 <- dat6 %>% select(-state,-FIPS)
```


#Save files to type rda

```{r}
save(dat4, file = file.path(rdadir, ""))
save(dat7, file = file.path(rdadir, ""))
```

