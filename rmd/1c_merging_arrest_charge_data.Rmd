---
title: "1c_Combining Arrest Data"
author: "Brit Henderson"
date: "Last Updated: `r format(Sys.time(), '%d %B, %Y')`"
output: html_document
---

# Objective
Combine the different charge types into one arrest counts file
```{r directories}
readdatdir <- "/data/share/xproject/Training/Practice/henderson/Dissertation/rda/Intermediate"
rdadir <- "/data/share/xproject/Training/Practice/henderson/Dissertation/rda"

```

```{r functions}

```

```{r packages}
# # Import packages
library(Hmisc)
library(tidyverse) # suite of packages in for manipulating/tidying/visualizing, etc. data
library(lubridate) # manipulating dates
library(readxl)  # read in excel files
library(knitr) # for RMD formatting
library(kableExtra) # to output tables as images
library(fastDummies) # easy creation of dummy variables 



```


#Load the data sets
```{r data}
dat.index <- readRDS(here::here("rda/Intermediate/int_index.rds"))
dat.prop <- readRDS(here::here("rda/Intermediate/int_prop.rds"))
dat.drug <- readRDS(here::here("rda/Intermediate/int_drug.rds"))
dat.other <- readRDS(here::here("rda/Intermediate/int_other.rds"))




```

# merge data sets
```{r merge}

#put all data frames into list
df_list <- list(dat.index, dat.prop, dat.drug, dat.other)      

#merge all data frames together
all.arrests <- df_list %>% reduce(full_join, 
                                  by= c("ori","ori9","year","state","country_division", "fips_place_code","agency_name","fips_state_county_code", "state_abb",
                                        "population_group","population","longitude","latitude","fips_county_code", "fips_state_code","covered_by","number_of_months_reported"))

```



#summary statistics for all arrests data set
```{r stats}
summary(all.arrests)
describe(all.arrests)

```

```{r checks}

checkdat <- all.arrests %>% 
  group_by(year, agency_name, fips_place_code, fips_state_county_code) %>% 
  summarise(n = n())

summary(checkdat2)

hist(checkdat2$n)
table(checkdat2$n, useNA = "always")
checkdat2 <- all.arrests %>% count(year, agency_name, fips_place_code, fips_state_county_code)
```



#Cleaning final data set
```{r}
#dat7 <- dat6 %>% select(-state,-FIPS)
```


#Save files to type rda

```{r}
saveRDS(all.arrests, file = file.path(rdadir, "all_arrests.rds"))
```

